# Ticket Notes for January 2018

## Contents

* <a href="#lm-103696-white_check_mark">LM-103696 :white_check_mark:</a>
    * Refresh named account grid after linking
* <a href="#lm-103697-white_check_mark">LM-103697 :white_check_mark:</a>
    * Refresh named account grid after unlinking
* <a href="#lm-106451-white_check_mark">LM-106451 :white_check_mark:</a>
    * Named account grid not getting refreshed dynamically after account is linked/unlinked
* <a href="#lm-105731-white_check_mark">LM-105731 :white_check_mark:</a>
    * No error when trying to delete an account part of a Dynamic Account List
* <a href="#lm-105869-white_check_mark">LM-105869 :white_check_mark:</a>
    * Unlink menu greyout when at least one selected account is not linked
* <a href="#lm-106507-white_check_mark">LM-106507 :white_check_mark:</a>
    * New rules for state of menu options based on selected row in NA Grid
* <a href="#lm-106513-white_check_mark">LM-106513 :white_check_mark:</a>
    * The link/unlink menus should not be enabled if there is a CRM account selected
* <a href="#lm-106567-white_check_mark">LM-106567 :white_check_mark:</a>
    * Hide Link and Unlink from Named Account Actions when it shows plain Named Account Grid
* <a href="#lm-103622-white_check_mark">LM-103622 :white_check_mark:</a>
    * Remove unnecessary calls in AccountListAccess.php class to APIs
* <a href="#lm-106022-white_check_mark">LM-106022 :white_check_mark:</a>
    * Includes children panel is unresponsive when tree is large
* <a href="#lm-106210-white_check_mark">LM-106210 :white_check_mark:</a>
    * Paging still not working in Named Account Hierarchy Grid
* <a href="#lm-106252-white_check_mark">LM-106252 :white_check_mark:</a>
    * Hierarchy tab is unresponsive after rendering 10k accounts
* <a href="#lm-98513-white_check_mark">LM-98513 :white_check_mark:</a>
    * Both lists remain highlighted if you switch the selection from dynamic account list to static one or vice versa
* <a href="#lm-106640-white_check_mark">LM-106640 :white_check_mark:</a>
    * Only keep name, country, crmGuid columns in Hierarchy Tab of Named Account Dashboard
* <a href="#lm-106484-white_check_mark">LM-106484 :white_check_mark:</a>
    * Add descendants count next to account name in Hierarchy grid
* <a href="#lm-106501-white_check_mark">LM-106501 :white_check_mark:</a>
    * Append the string "Group" next to account name in all group rows in hierarchy
* <a href="#lm-106007-o">LM-106007 :o:</a>
    * Include children panel has no indication that it is loading
* <a href="#lm-106910-o">LM-106910 :o:</a>
    * Bandaid upon loading ABM due to null totalDescendantsCount
* <a href="#lm-106734-o">LM-106734 :o:</a>
    * When expanding an element in the includes children panel, menu is automatically scrolled to the top
* <a href="#lm-106729-white_check_mark">LM-106729 :white_check_mark:</a>
    * Link/Unlink are not disabled when use shift-click muliselect on CRM accounts
* <a href="#lm-106725-o">LM-106725 :o:</a>
    * Change Apply button warning message after UX is ready in Includes Children panel for more than 100 accounts selected

## LM-103696 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-103696?filter=-1
* **Description:** Refresh named account grid after linking
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/NamedAccountHierachyGrid.js
* **Controller:**
  * /web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
  * /web/mkt-3.0/app/controller/abm/namedAccount/LinkToNamedAccountForm.js
  
Create patch file in local environment:

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/LinkToNamedAccountForm.js > LM-103696.patch

# Patch to INT
patch -p0 < LM-103696.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-103696.patch

# Commit
svn commit -m "LM-103696 Refresh named account grid after linking." web/mkt-3.0/app/controller/abm/namedAccount/LinkToNamedAccountForm.js
```

## LM-103697 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-103697?filter=-1
* **Description:** Refresh named account grid after unlinking
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/Toolbar.js
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
  
Create patch file in local environment:

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js > LM-103697.patch

# Patch to INT
patch -p0 < LM-103697.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-103697.patch

# Commit
svn commit -m "LM-103697 Refresh named account grid after unlinking." web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
```

## LM-106451 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-103697?filter=-1
* **Description:** Named account grid not getting refreshed dynamically after account is linked/unlinked
* **Controller:** /web/mkt-3.0/app/view/abm/namedAccount/NamedAccountHierarchyGrid.js

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountHierarchyGrid.js > LM-106451.patch

# Patch to INT
patch -p0 < LM-106451.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106451.patch

# Commit
svn commit -m "LM-106451 Refresh named account fixed after linking/unlinking." web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountHierarchyGrid.js
```


## Refresh Grid after Creating Named Accounts

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/CreateForm.js > LM-XXX-refresh-hierachy-grid-after-creating-named-accounts.patch
# Patch to INT
patch -p0 < LM-XXX-refresh-hierachy-grid-after-creating-named-accounts.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-XXX-refresh-hierachy-grid-after-creating-named-accounts.patch
```

## LM-105731 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-105731?filter=-1
* **Description:** No error when trying to delete an account part of a Dynamic Account List
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js > LM-105731.patch

# Patch to INT
patch -p0 < LM-105731.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-105731.patch
# Commit
svn commit -m "LM-105731 Show error when trying to delete an account part of a Dynamic Account List" web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
```

## LM-105869 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-105869?filter=-1
* **Description:** Unlink menu greyout when at least one selected account is not linked
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountHierarchyGrid.js

```javascript
onGridSelectionChange: function(selectionModel) {
  var canvas = this.getGridCanvas(),
      toolbar = canvas.down('abmNamedAccountToolbar'),
      unlinkBtn = toolbar.down('[action=unlinkAccounts]'),
      selectedItems = selectionModel.selected.items;
      
  canvas.refreshState();
  
  // Check unlinked accounts
  // If at least one account has no parent, disable 'unlink' button.
  for (var i = 0; i < selectedItems.length; i++) {
    var currItem = selectedItems[i];
    if (isNaN(currItem.data.parentId)) {
      unlinkBtn.setDisabled(true);
      break;
    }
  }
},
```

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountHierarchyGrid.js > LM-105869.patch

# Patch to INT
patch -p0 < LM-105869.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-105869.patch

# Commit
svn commit -m "LM-105869 Unlink menu greyout when at least one selected account is not linked." web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountHierarchyGrid.js
```

## LM-106507 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106507?filter=-1
* **Description:** New rules for state of menu options based on selected row in NA Grid
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js

If a group folder is selected, all Named Account actions except "Check Import status" should be disabled.

If a parent node is selected, the unlink should be available if it is linked already.

Resolved together with the following ticket LM-106567.

```bash
svn diff web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js > LM-106507.patch
# Commit
svn commit -m "LM-106507 New rules for state of menu options based on selected row in NA Grid" web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
svn commit -m "LM-106507-followup New rules for state of menu options based on selected row in NA Grid" web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
```

## LM-106513 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106513?filter=-1
* **Description:** The link/unlink menus should not be enabled if there is a CRM account selected
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js

Resolved together with the following ticket LM-106567.

Reopened to LM-106729: needs to work for multiselection with shift-click.

```bash
svn diff web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js > LM-106513-follow-up.patch
svn commit -m "LM-106513 The link/unlink menus should not be enabled if there is a CRM account selected" web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
```

## LM-106567 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106567?filter=-1
* **Description:** Hide Link and Unlink from Named Account Actions when it shows plain Named Account Grid
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js

```bash
svn diff web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js > LM-106567.patch
# Patch to INT
patch -p0 < LM-106567.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106567.patch
# Commit
svn commit -m "LM-106567, LM-106513, LM-106507 Hide Link and Unlink from Named Account Actions when it shows plain Named Account Grid, New rules for state of menu options based on selected row in NA Grid, he link/unlink menus should not be enabled if there is a CRM account selected" web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
```

## LM-103622 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-103622?filter=-1
* **Description:** Remove unnecessary calls in AccountListAccess.php class to APIs
* **File:** /apps/search/lib/data/AccountListAccess.php

How to test the number of API calls made in the php file (`AccountListAccess.php`):

1. Find out which function gets called in the php file to fetch the account list detail: `$accounts = $service->getAccountListById($accountListId);`.
2. Double click the function name and press `Command + B` to view its definition. We then have the function defined in `AbsService.php`.
3. Double click the function `getAccountListByIdURL()` in the definition of `getAccountListById()` and find its source code in `AbmServiceConfig.php`.
4. The function used a string `app_abm_service_get_account_list_by_id_url` in it. Search for `get_account_list_by_id_url` in `apps/search/config/app.yml`:

```
...
abm_service:
  ...
  # Account list operations
  get_account_lists_url: /v1/accountListManagement/munchkin/{munchkinId}/accountLists.json
  get_account_list_by_id_url: /v1/accountListManagement/munchkin/{munchkinId}/accountLists/{accountListId}/accountList.json
  ...  
```

So the API call is to fecth data from a file called `accountLists.json`. Then run the command: `tail -F log/bcabmintCustomer.log` and then click any account list. Search for `accountLists.json` in the log. It should show up twice, means that the API gets called twice.

Go to `/www/mkto` in the INT server and run the command: 

```bashc
cd /Users/lqin/devdocker/mlm
svn diff apps/search/lib/data/AccountListAccess.php > LM-103622.patch

# Patch to INT
patch -p0 < LM-103622.patch
# Revert patch:
patch -p0 -R < LM-103622.patch

# Commit
svn commit -m "LM-103622 Remove unnecessary calls in AccountListAccess.php class to APIs." apps/search/lib/data/AccountListAccess.php
```

## LM-106022 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106022?filter=-1
* **Description:** Includes children panel is unresponsive when tree is large
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/IncludesChildrenPanel.js
* **Backend Files:** 
    * /apps/search/modules/abm/actions/actions.class.php (line 2611)
    * /lib/abmService/transport/AbmService.php (line 595)

It works fine on Firefox and Safari, only slow on Chrome. Related post: https://www.sencha.com/forum/showthread.php?309824-Normal-grid-scrolling-is-very-slow-after-sew-smooth-scrolling-feature-in-chrome

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/view/abm/namedAccount/IncludesChildrenPanel.js > LM-106022.patch

# Patch to INT
patch -p0 < LM-106022.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106022.patch

# Commit
svn commit -m "LM-106022 Improved the performance by allowing only one subtree can be expanded in the same level." web/mkt-3.0/app/view/abm/namedAccount/IncludesChildrenPanel.js
```

## LM-106210 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106210?filter=-1
* **Description:** Paging still not working in Named Account Hierarchy Grid
* **Backend Files:** /lib/abmService/transport/AbmService.php (line 595)
    
```bash
cd /Users/lqin/devdocker/mlm
svn diff lib/abmService/transport/AbmService.php > LM-106210.patch

# Patch to INT
patch -p0 < LM-106210.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106210.patch

# Commit
svn commit -m "LM-106210 Updated totalCount and paging works in NamedAccountHierarchyGrid" lib/abmService/transport/AbmService.php
```

## LM-106252 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106252?filter=-1
* **Description:** Hierarchy tab is unresponsive after rendering 10k accounts
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/Dashboard.js
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js

Related posts: https://www.sencha.com/forum/showthread.php?280879-Ext-Js-Tree-Panel-Expand-and-Select-a-deeper-node

Updates I made to improve the performance:

1. Expand only the subtree that contains the selected named account, other subtrees collapsed
2. Scroll to the node and it is highlighted
3. Highlight the selected named account
4. Removed the animation when expanding the tree (so that auto-scroll works)

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/controller/abm/namedAccount/Dashboard.js web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js > LM-106252.patch
# Patch to INT
patch -p0 < LM-106252.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106252.patch
# Commit
svn commit -m "LM-106252 Performance improvement for hierarchy tab with 10k accounts" web/mkt-3.0/app/controller/abm/namedAccount/Dashboard.js web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js
```

## LM-98513 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-98513?filter=-1
* **Description:** Both lists remain highlighted if you switch the selection from dynamic account list to static one or vice versa
* **View:** /web/mkt-3.0/app/controller/abm/accountList/AccountListTree.js
```bash
svn diff web/mkt-3.0/app/controller/abm/accountList/AccountListTree.js > LM-98513.patch

# Patch to INT
patch -p0 < LM-98513.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-98513.patch
svn commit -m "LM-98513 Only one account will be highlighted if you switch the selection from dynamic account list to static one or vice versa" web/mkt-3.0/app/controller/abm/accountList/AccountListTree.js
```

## LM-106640 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106640?filter=-1
* **Description:** Only keep name, country, crmGuid columns in Hierarchy Tab of Named Account Dashboard.
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js
* **Mock Json:** /test/abm/data/hierarchyTab.json
```bash
svn diff web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js test/abm/data/hierarchyTab.json > LM-106640.patch
# Patch to INT
patch -p0 < LM-106640.patch
php batch/compressScripts.php
patch -p0 -R < LM-106640.patch
# Commit
svn commit -m "LM-106640 Only keep name, country, crmGuid columns in Hierarchy Tab of Named Account Dashboard" web/mkt-3.0/app/view/abm/namedAccount/Hierarchy.js test/abm/data/hierarchyTab.json
```

## LM-106484 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106484?filter=-1
* **Description:** Add descendants count next to account name in Hierarchy grid
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js

Wait for the backend API to return the number of total descendants for a named account.

Resolved together as the following ticket (LM-106501).

## LM-106501 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106501?filter=-1
* **Description:** Append the string "Group" next to account name in all group rows in hierarchy
* **Model:** /web/mkt-3.0/app/model/NamedAccountHierarchy.js
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js
* **Mock Json:** /test/abm/data/namedAccounts.json
* **Backend Object:** /apps/search/lib/data/object/NamedAccountObject.php
* **Backend Access:** /apps/search/lib/data/NamedAccountAccess.php
* **Data Object Yml:** /config/data_objects.yml

In order to add a field to return from a `retrive` call, open the yml file and search for `namedAccount`. Then added a new column there: 
```yml
namedAccount:
  fields:
    ...
    totalDescendantsCount:
      type: int
      isNull: true
      isSynced: true
    ...
```

Then enter the docker environment to rebuild the data object, `NamedAccountObject.php` will be re-generated. Note that `NamedAccountObject.php` should also be checked in. 
```
docker exec -it mlmmax_mlm_1 sh
cd src/mlm
php batch/buildDataObjects.php
exit
```

Then add a field in `$fieldMap` of `NamedAccountAccess.php`:
```php
static protected $fieldMap = array(
  ...
  NamedAccountObject::TOTAL_DESCENDANTS_COUNT => self::CUSTOM_MAPPING,
  ...
);
```

Now we can have the field `totalDescendantsCount` from the ajax call `retrieve`. Also need to modify the front-end code to display it. First of all, we should add the field in the front-end model `NamedAccountHierarchy.js`:
```javascript
  fields: [
    ...
    {
      name: 'totalDescendantsCount',
      type: 'int',
      defaultValue: "1",
    },
    ...
  ]
```

In order to avoid conflicts, the class name for the badge span should be: `Mkt3.cssPrefix + 'abmHierarchyGrid-group-badge'`.

`Mkt3.cssPrefix` would equal to `#{$ns}` in scss files, which is `mkt3-`, while `#{$nsx}` is for extjs classes, that would be `x4-` when resolved in css.

```bash
cd /Users/lqin/devdocker/mlm
svn diff web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js web/mkt-3.0/app/view/abm/discoverCRM/GridPanel.js web/mkt-3.0/app/view/abm/discoverCRM/GridPanel.js web/mkt-3.0/resources/sass/widgets/_abmHierarchyGrid.scss > LM-106501.patch
svn diff web/mkt-3.0/resources/css/* > LM-106501-css.patch

# Follow up files to check:
# 1. Back-end files:
#   1.1. yml file to define column name
#   1.2. object file re-generated
#   1.3. access php file
#   1.4. mock data json file
# 2. Front-end files:
#   2.1. model file to add new column
#   2.2. view component to display the span
#   2.3. scss file for the style
#   2.4. css files generated
svn diff config/data_objects.yml apps/search/lib/data/object/NamedAccountObject.php apps/search/lib/data/NamedAccountAccess.php test/abm/data/namedAccounts.json web/mkt-3.0/app/model/NamedAccountHierarchy.js web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js web/mkt-3.0/resources/sass/widgets/_abmHierarchyGrid.scss web/mkt-3.0/resources/css/*.css > LM-106501-followup.patch

# Patch to INT
patch -p0 < LM-106501.patch
php batch/compressScripts.php
# Revert patch:
patch -p0 -R < LM-106501.patch

# Commit
svn commit -m "LM-106501, LM-106484 Append the string 'Group' and descendants count next to account name in all group rows in hierarchy" web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js web/mkt-3.0/app/view/abm/discoverCRM/GridPanel.js web/mkt-3.0/resources/sass/widgets/_abmHierarchyGrid.scss
svn commit -m "LM-106501-follow-up Rebuilt css files." web/mkt-3.0/resources/css/*

svn commit -m "LM-106501-follow-up Updates for NamedAccountHierarchy model, namedAccountObject and mock data." config/data_objects.yml apps/search/lib/data/object/NamedAccountObject.php apps/search/lib/data/NamedAccountAccess.php test/abm/data/namedAccounts.json web/mkt-3.0/app/model/NamedAccountHierarchy.js web/mkt-3.0/app/view/abm/namedAccount/NamedAccountGrid.js web/mkt-3.0/resources/sass/widgets/_abmHierarchyGrid.scss web/mkt-3.0/resources/css/*.css
```

## LM-106007 :o:

* **URL:** https://resource.marketo.com/jira/browse/LM-106007?filter=-1
* **Description:** Include children panel has no indication that it is loading.
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
* **Styles** /web/mkt-3.0/resources/sass/widgets/\_abmIncludeChildrenPanel.scss

```bash
svn diff web/mkt-3.0/app/view/abm/namedAccount/Toolbar.js web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js web/mkt-3.0/resources/sass/widgets/_abmIncludeChildrenPanel.scss > LM-106007.patch
# Patch to INT
patch -p0 < LM-106007.patch
php batch/compressScripts.php
patch -p0 -R < LM-106007.patch

svn commit -m "LM-106007 Added indication for includingChildrenPanel." web/mkt-3.0/app/view/abm/namedAccount/Toolbar.js web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js web/mkt-3.0/resources/sass/widgets/_abmIncludeChildrenPanel.scss web/mkt-3.0/resources/css/*.css
```

## LM-106910 :o:

* **URL:** https://resource.marketo.com/jira/browse/LM-106910?filter=-1
* **Description:** Bandaid upon loading ABM due to null totalDescendantsCount.
* **Data Access File:** /apps/search/lib/data/NamedAccountAccess.php

```bash
svn diff apps/search/lib/data/NamedAccountAccess.php > LM-106910.patch
svn commit -m "LM-106910 Fixed bandaid upon loading ABM due to null totalDescendantsCount." apps/search/lib/data/NamedAccountAccess.php
```

## LM-106734 :o:

* **URL:** https://resource.marketo.com/jira/browse/LM-106734?filter=-1
* **Description:** When expanding an element in the includes children panel, menu is automatically scrolled to the top.
* **Controller:** /web/mkt-3.0/app/controller/abm/namedAccount/Dashboard.js

The auto-scrolling is fired by the framework source code:
```javascript
// web/ext-4.1.3/src/view/Table.js: line 484
refreshSize: function() {
    ...
        Ext.resumeLayouts(true); // This is the line
    ...
},
```
Therefore, the table will scroll to top whenever we refresh its size, that is, change the height. I then set the table height manually so that the table height will not be updated when we expand/collapse a node.

```bash
svn diff web/mkt-3.0/app/controller/abm/namedAccount/Dashboard.js > LM-106734.patch
# Patch to INT
patch -p0 < LM-106734.patch
php batch/compressScripts.php
patch -p0 -R < LM-106734.patch
```

## LM-106729 :white_check_mark:

* **URL:** https://resource.marketo.com/jira/browse/LM-106729?filter=-1
* **Description:** Link/Unlink are not disabled when use shift-click muliselect on CRM accounts
* **Controller:**
    * /web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js
    * /web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
* **View:** /web/mkt-3.0/app/view/abm/namedAccount/Toolbar.js

Moved the button disabling logic from `NamedAccountGrid.onGridSelectionChange()` to `Toolbar.onToggleNamedAccountActions()` so that we can get all selected items after shift select.
```bash
svn diff web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js > LM-106729.patch
# Patch to INT
patch -p0 < LM-106729.patch
php batch/compressScripts.php
patch -p0 -R < LM-106729.patch
svn commit -m "LM-106729 Link/Unlink are disabled when use shift-click muliselect on CRM accounts" web/mkt-3.0/app/controller/abm/namedAccount/Toolbar.js web/mkt-3.0/app/controller/abm/namedAccount/NamedAccountGrid.js
```

## LM-106725 :o:

* **URL:** https://resource.marketo.com/jira/browse/LM-106725?filter=-1
* **Description:** Change Apply button warning message after UX is ready in Includes Children panel for more than 100 accounts selected.
* **Controller:** 